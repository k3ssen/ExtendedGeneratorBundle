{# @var meta_entity \K3ssen\GeneratorBundle\MetaData\MetaEntityInterface #}
{# @var generate_options \K3ssen\ExtendedGeneratorBundle\Generator\CrudGenerateOptions#}
{% use '@!Generator/skeleton/security/_methods.php.twig' %}
{% block methods %}

    /**
     * @var {{ meta_entity.name }}|null $object the entity object
     */
    protected function voteOnAttribute($attribute, $object = null): bool
    {
        switch ($attribute) {
            case self::INDEX:
{% if generate_options.useDatatable %}
            case self::SEARCH:
{% endif %}
            case self::CREATE:
                return $this->isAdmin();
            case self::VIEW:
{% if generate_options.useWriteActions %}
            case self::EDIT:
            case self::DELETE:
{% endif %}
                return $object && $this->isAdmin();
        }
        return false;
    }
{% endblock %}